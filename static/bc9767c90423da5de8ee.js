"use strict";(self.webpackChunkcloud_onchain_trade_sdk=self.webpackChunkcloud_onchain_trade_sdk||[]).push([[6851],{68575:(e,t,r)=>{r.d(t,{lZ:()=>M,g2:()=>Z,oc:()=>T,ud:()=>L,sW:()=>A,k3:()=>P,oM:()=>B,J6:()=>W,Iw:()=>S,yS:()=>O,rl:()=>q,As:()=>R});var a=r(27618),s=r(72062),n=r(84400);const o=e=>n.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e},n.createElement("path",{d:"M7.757 7.757a1 1 0 000 1.415L10.585 12l-2.828 2.829a1 1 0 101.414 1.414L12 13.414l2.828 2.829a1 1 0 001.414-1.414L13.414 12l2.828-2.828a1 1 0 00-1.414-1.415L12 10.586 9.17 7.757a1 1 0 00-1.414 0z"}),n.createElement("path",{fillRule:"evenodd",d:"M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10 10-4.477 10-10zm-2 0a8 8 0 10-16 0 8 8 0 0016 0z",clipRule:"evenodd"}));var i=r(83896),l=r(57255),c=r(89663);const m=()=>{let e,t;return{promise:new Promise(((r,a)=>{e=r,t=a})),resolve:e,reject:t}};var d=r(29864),g=r(35805),u=r(82711),p=r(10108),b=r(4592),f=r(86645);const E=e=>n.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,className:"animate-spin"},n.createElement("circle",{opacity:"0.2",cx:"8.99969",cy:"8.99994",r:"7.40741",stroke:"white",strokeWidth:"1.6"}),n.createElement("path",{d:"M8.96342 1.59253C10.3009 1.59253 11.6136 1.95111 12.7637 2.63056C13.9137 3.31002 14.8585 4.28525 15.4988 5.45373C16.1391 6.62221 16.4512 7.94078 16.4023 9.27079C16.3534 10.6008 15.9453 11.8932 15.2209 13.0119C14.4965 14.1307 13.4826 15.0346 12.2857 15.6286C11.0889 16.2227 9.75328 16.4848 8.4194 16.3875C7.08552 16.2903 5.80261 15.8372 4.70556 15.0759C3.6085 14.3146 2.73782 13.2733 2.18506 12.0614",className:"stroke-t-link",strokeWidth:"1.6"}));var N=r(95386),h=r(59712);const v=(e,t="resolve")=>new Promise(((r,a)=>setTimeout((()=>{"resolve"===t?r(!0):a()}),e))),k=(e,t=115n)=>e*t/100n,w=1e3,I=2500,y=({getI18n:e,isLong:t,leverage:r,symbol:s,brokerWidgetConfig:o={}})=>{const{brokerName:i}=o;return n.createElement("span",{className:"px-1 relative isolate rounded overflow-hidden inline-block text-subtitle3 order-form-trading-badge "+(t?"bg-support-success/20":"bg-support-error/20")},n.createElement("span",{className:(0,a.cn)("z-[20]",t?"text-t-buy":"text-t-sell")},"astherus"===i&&"- ",t?e("orderForm-long","Long"):e("orderForm-short","Short")," ",s||""," ",r?`${(0,c.uf)(r,0)}x`:""))},x=({getI18n:e})=>n.createElement("div",{className:"flex items-center gap-1"},n.createElement(E,{className:"w-5 h-5 text-t-link"}),n.createElement("p",{className:"flex text-t-secondary items-center gap-1 text-caption1 h-5"},e("orderForm-wait-for-confirmation","Waiting for confirmation on-chain"))),C=({getI18n:e,brokerWidgetConfig:t={}})=>{const{icons:r={}}=t;return n.createElement("p",{className:"flex text-t-secondary items-center gap-1 text-caption1 h-5"},r.CircledCheckmarkD?n.createElement(r.CircledCheckmarkD,{className:"w-5 h-5 text-support-success"}):n.createElement(s.X,{className:"w-5 h-5 text-support-success"}),e("orderForm-confirmed-success","Confirmed Success"))},F=({getI18n:e,brokerWidgetConfig:t={}})=>{const{icons:r={}}=t;return n.createElement("p",{className:"flex text-t-secondary items-center gap-1 text-caption1 h-5"},r.CircledCloseD?n.createElement(r.CircledCloseD,{className:"w-5 h-5 text-support-error"}):n.createElement(o,{className:"w-5 h-5 text-support-error"}),e("orderForm-order-failed","Failed"))},P=async({address:e,amountIn:t,config:r,getI18n:a,leverage:s,onUserConfirm:o,openMarketTradeParams:c,symbol:b,tokenInName:N,brokerWidgetConfig:k})=>{let P;if(c.tokenIn&&"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"!==c.tokenIn){const t=await(0,d.a)(r,{address:e,abi:f.Z,functionName:"openMarketTrade",args:[{...c,tokenIn:c.tokenIn}]});P=await(0,g.n)(r,t.request)}else{const t=await(0,d.a)(r,{address:e,abi:f.Z,functionName:"openMarketTradeBNB",args:[{...c,tokenIn:"0x0000000000000000000000000000000000000000"}],value:c.amountIn});P=await(0,g.n)(r,t.request)}const W=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},a("orderForm-order-placing","Order placing")),n.createElement(y,{brokerWidgetConfig:k,isLong:c.isLong,symbol:b,leverage:s,getI18n:a})),n.createElement("p",{className:"text-caption1 text-t-secondary"},t," ",N," ",a("orderForm-open-trade-current-price","at the current market price")),n.createElement(i.Z,{decorative:!0,className:"my-2"})),A=(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(x,{getI18n:a,brokerWidgetConfig:k})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});let L;o?.();try{L=await(0,u.e)(r,{hash:P,pollingInterval:w,timeout:3e4})}catch(e){return void(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(F,{getI18n:a,brokerWidgetConfig:k})),{duration:I,dismissible:!0,id:A,className:"border-support-error order-form-fail-toast"})}(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement("div",{className:"flex items-center gap-1"},n.createElement(E,{className:"w-5 h-5 text-t-link"}),n.createElement("p",{className:"flex text-t-secondary items-center gap-1 text-caption1 h-5"},a("orderForm-verify-oracle-price","Verifying Oracle price")))),{duration:1/0,id:A,dismissible:!1});const T=L.logs.find((e=>"0x7064b82c073f138da0ec7646ebb51d4a0061d647accb4670bc564edf0bfac41d"===e.topics[0]))?.topics[2],{promise:Z,resolve:M,reject:O}=m(),S=(0,p.Y)(r,{abi:f.Z,eventName:"OpenMarketTrade",batch:!1,address:e,pollingInterval:w,onLogs(e){e.find((e=>e.topics[2]===T))&&M()},onError(e){h.debug("unwatchOpenMarketTrade",e.message)}}),q=(0,p.Y)(r,{abi:f.Z,eventName:"PendingTradeRefund",batch:!1,address:e,pollingInterval:w,onLogs(e){e.find((e=>e.topics[2]===T))&&O()},onError(e){h.log("unwatchPendingTradeRefund",e.message)}});await Promise.race([Z,v(2e4)]).then((()=>{(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(C,{getI18n:a,brokerWidgetConfig:k})),{duration:I,dismissible:!0,id:A,className:"border-support-success order-form-success-toast"})})).finally((()=>{S(),q()})).catch((e=>{h.error(e),(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(F,{getI18n:a,brokerWidgetConfig:k})),{duration:I,dismissible:!0,id:A,className:"border-support-error order-form-fail-toast"})}))},W=async({address:e,amountIn:t,config:r,getI18n:a,leverage:s,onUserConfirm:o,openMarketTradeParams:c,publicClient:b,symbol:N,tokenInName:P,brokerWidgetConfig:W={}})=>{const{swapData:A,data:L}=c,T=await(0,d.a)(r,{address:e,abi:f.Z,functionName:"swapAndOpenMarketTrade",args:[A,{...L,tokenIn:L.tokenIn}]}),Z=await b.estimateContractGas(T.request),M=await(0,g.n)(r,{...T.request,gas:k(Z)}),O=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},a("orderForm-order-placing","Order placing")),n.createElement(y,{isLong:c.data.isLong,symbol:N,leverage:s,getI18n:a})),n.createElement("p",{className:"text-caption1 text-t-secondary"},t," ",P," ",a("orderForm-open-trade-current-price","at the current market price")),n.createElement(i.Z,{decorative:!0,className:"my-2"})),S=(0,l.A)(n.createElement(n.Fragment,null,O,n.createElement(x,{getI18n:a})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});let q;o?.();try{q=await(0,u.e)(r,{hash:M,pollingInterval:w,timeout:3e4})}catch(e){(0,l.A)(n.createElement(n.Fragment,null,O,n.createElement(F,{getI18n:a,brokerWidgetConfig:W})),{duration:I,dismissible:!0,id:S,className:"border-support-error order-form-fail-toast"})}(0,l.A)(n.createElement(n.Fragment,null,O,n.createElement("div",{className:"flex items-center gap-1"},n.createElement(E,{className:"w-5 h-5 text-t-link"}),n.createElement("p",{className:"flex text-t-secondary items-center gap-1 text-caption1 h-5"},a("orderForm-verify-oracle-price","Verifying Oracle price")))),{duration:1/0,id:S,dismissible:!1});const B=q.logs.find((e=>"0x7064b82c073f138da0ec7646ebb51d4a0061d647accb4670bc564edf0bfac41d"===e.topics[0]))?.topics[2],{promise:R,resolve:$,reject:D}=m(),U=(0,p.Y)(r,{abi:f.Z,eventName:"OpenMarketTrade",batch:!1,address:e,pollingInterval:w,onLogs(e){e.find((e=>e.topics[2]===B))&&$()},onError(e){h.debug("unwatchOpenMarketTrade",e.message)}}),G=(0,p.Y)(r,{abi:f.Z,eventName:"PendingTradeRefund",batch:!1,address:e,pollingInterval:w,onLogs(e){e.find((e=>e.topics[2]===B))&&D()},onError(e){h.log("unwatchPendingTradeRefund",e.message)}});await Promise.race([R,v(6e4)]).then((()=>{(0,l.A)(n.createElement(n.Fragment,null,O,n.createElement(C,{getI18n:a,brokerWidgetConfig:W})),{duration:I,dismissible:!0,id:S,className:"border-support-success order-form-success-toast"})})).finally((()=>{U(),G()})).catch((e=>{h.error(e),(0,l.A)(n.createElement(n.Fragment,null,O,n.createElement(F,{getI18n:a,brokerWidgetConfig:W})),{duration:I,dismissible:!0,id:S,className:"border-support-error order-form-fail-toast"})}))},A=async({address:e,amountIn:t,config:r,getI18n:a,leverage:s,limitPrice:o,onUserConfirm:m,openLimitOrderParams:p,publicClient:b,symbol:E,tokenInName:N,brokerWidgetConfig:v={}})=>{const P=p.tokenIn&&"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"!==p.tokenIn?await(0,d.a)(r,{address:e,abi:f.Z,functionName:"openLimitOrder",args:[{...p,tokenIn:p.tokenIn}]}):await(0,d.a)(r,{address:e,abi:f.Z,functionName:"openLimitOrderBNB",args:[{...p,tokenIn:"0x0000000000000000000000000000000000000000"}],value:p.amountIn}),W=await b.estimateContractGas(P.request),A=await(0,g.n)(r,{...P.request,gas:k(W)}),L=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},a("orderForm-order-placing","Order placing")),n.createElement(y,{brokerWidgetConfig:v,isLong:p.isLong,symbol:E,leverage:s,getI18n:a})),n.createElement("p",{className:"text-caption1 text-t-secondary"},t," ",N," ",a("orderForm-at","at")," $",(0,c.uf)(o,2)),n.createElement(i.Z,{decorative:!0,className:"my-2"})),T=(0,l.A)(n.createElement(n.Fragment,null,L,n.createElement(x,{getI18n:a})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});m?.();try{await(0,u.e)(r,{hash:A,pollingInterval:w})}catch(e){return h.error(e),void(0,l.A)(n.createElement(n.Fragment,null,L,n.createElement(F,{getI18n:a,brokerWidgetConfig:v})),{duration:I,dismissible:!0,id:T,className:"border-support-error order-form-fail-toast"})}(0,l.A)(n.createElement(n.Fragment,null,L,n.createElement(C,{getI18n:a,brokerWidgetConfig:v})),{duration:I,dismissible:!0,id:T,className:"border-support-success order-form-success-toast"})},L=async({closeTradeParams:e,config:t,publicClient:r,address:a,getI18n:s,isLong:o,leverage:c,symbol:b,brokerWidgetConfig:E={}})=>{const N=await(0,d.a)(t,{address:a,abi:f.Z,functionName:"closeTrade",args:[e]}),P=await r.estimateContractGas(N.request),W=await(0,g.n)(t,{...N.request,gas:k(P)}),A=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},s("orderForm-position-closing","Position Closing")),n.createElement(y,{brokerWidgetConfig:E,isLong:o,symbol:b,leverage:c,getI18n:s})),n.createElement(i.Z,{decorative:!0,className:"my-2"})),L=(0,l.A)(n.createElement(n.Fragment,null,A,n.createElement(x,{getI18n:s})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});try{await(0,u.e)(t,{hash:W,pollingInterval:w})}catch(e){return void(0,l.A)(n.createElement(n.Fragment,null,A,n.createElement(F,{getI18n:s,brokerWidgetConfig:E})),{duration:I,dismissible:!0,id:L,className:"border-support-error order-form-fail-toast"})}const{promise:T,resolve:Z}=m(),M=(0,p.Y)(t,{abi:f.Z,eventName:"CloseTradeSuccessful",batch:!1,address:a,pollingInterval:w,onLogs(t){t.find((t=>t.args.tradeHash===e))&&Z()},onError(e){h.debug("unwatchPendingTradeRefund",e.message)}});await Promise.race([T,v(6e4,"reject")]).then((()=>{(0,l.A)(n.createElement(n.Fragment,null,A,n.createElement(C,{getI18n:s,brokerWidgetConfig:E})),{duration:I,dismissible:!0,id:L,className:"border-support-success order-form-success-toast"})})).finally((()=>{M()})).catch((e=>{throw h.error(e),(0,l.A)(n.createElement(n.Fragment,null,A,n.createElement(F,{getI18n:s,brokerWidgetConfig:E})),{duration:I,dismissible:!0,id:L,className:"border-support-error order-form-fail-toast"}),e}))},T=async({closeTradeParams:e,config:t,publicClient:r,address:a,getI18n:s,brokerWidgetConfig:o={}})=>{const c=await(0,d.a)(t,{address:a,abi:f.Z,functionName:"batchCloseTrade",args:[e]}),b=await r.estimateContractGas(c.request),E=await(0,g.n)(t,{...c.request,gas:k(b)}),N=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},s("orderForm-closing-all-position","Closing All Position"))),n.createElement(i.Z,{decorative:!0,className:"my-2"})),y=(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(x,{getI18n:s})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});try{await(0,u.e)(t,{hash:E,pollingInterval:w})}catch(e){return h.error(e),void(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(F,{getI18n:s,brokerWidgetConfig:o})),{duration:I,dismissible:!0,id:y,className:"border-support-error order-form-fail-toast"})}const{promise:P,resolve:W}=m(),A=Array.from(e),L=(0,p.Y)(t,{abi:f.Z,eventName:"CloseTradeSuccessful",batch:!1,address:a,pollingInterval:w,onLogs(e){const t=e.map((e=>e.args.tradeHash));t[0]&&A.splice(A.indexOf(t[0]),1),0===A.length&&W()},onError(e){h.debug("unwatchPendingTradeRefund",e.message)}});await Promise.race([P,v(6e4,"reject")]).then((()=>{(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(C,{getI18n:s,brokerWidgetConfig:o})),{duration:I,dismissible:!0,id:y,className:"border-support-success order-form-success-toast"})})).finally((()=>{L()})).catch((e=>{throw h.error(e),(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(F,{getI18n:s,brokerWidgetConfig:o})),{duration:I,dismissible:!0,id:y,className:"border-support-error order-form-fail-toast"}),e}))},Z=async({isLong:e,config:t,getI18n:r,cancelLimitOrderParams:a,symbol:s,address:o,leverage:c,brokerWidgetConfig:m={}})=>{const d=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},r("orderForm-cancel-limit-order","Order cancelling")),n.createElement(y,{brokerWidgetConfig:m,isLong:e,symbol:s,leverage:c,getI18n:r})),n.createElement(i.Z,{decorative:!0,className:"my-2"})),p=await(0,g.n)(t,{abi:f.Z,address:o,functionName:"cancelLimitOrder",args:[a]}),b=(0,l.A)(n.createElement(n.Fragment,null,d,n.createElement(x,{getI18n:r})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});await(0,u.e)(t,{hash:p,pollingInterval:w}),(0,l.A)(n.createElement(n.Fragment,null,d,n.createElement(C,{getI18n:r,brokerWidgetConfig:m})),{duration:I,dismissible:!0,id:b,className:"border-support-success order-form-success-toast"})},M=async e=>{const{address:t,config:r,addMarginParams:{hash:a,amount:s,marginToken:o},publicClient:c,getI18n:m,isLong:p,symbol:E,leverage:N,tokenName:v,onUserConfirm:P,decimals:W,brokerWidgetConfig:A={}}=e,L=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},m("orderForm-adding-margin","Adding Margin")),n.createElement(y,{brokerWidgetConfig:A,isLong:p,symbol:E,leverage:N,getI18n:m})),n.createElement("p",{className:"text-caption1 text-t-secondary"},m("orderForm-adding-token-as-margin",{defaultValue:"Adding {{amount}} {{tokenName}} as margin",tokenName:v,amount:(0,b.b)(s,W)})),n.createElement(i.Z,{decorative:!0,className:"my-2"})),T=o?await(0,d.a)(r,{address:t,abi:f.Z,functionName:"addMargin",args:[a,s]}):await(0,d.a)(r,{address:t,abi:f.Z,functionName:"addMargin",args:[a,s],value:s}),Z=await c.estimateContractGas(T.request),M=await(0,g.n)(r,{...T.request,gas:k(Z)}),O=(0,l.A)(n.createElement(n.Fragment,null,L,n.createElement(x,{getI18n:m})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});P?.();try{await(0,u.e)(r,{hash:M,pollingInterval:w})}catch(e){return h.error(e),void(0,l.A)(n.createElement(n.Fragment,null,L,n.createElement(F,{getI18n:m,brokerWidgetConfig:A})),{duration:I,dismissible:!0,id:O,className:"border-support-error order-form-fail-toast"})}(0,l.A)(n.createElement(n.Fragment,null,L,n.createElement(C,{getI18n:m,brokerWidgetConfig:A})),{duration:I,dismissible:!0,id:O,className:"border-support-success order-form-success-toast"})},O=async e=>{const{isLong:t,getI18n:r,leverage:a,symbol:s,config:o,takeProfitParams:{hash:m,takeProfitPrice:p},address:E,publicClient:h,onUserConfirm:v,updateType:F="position",brokerWidgetConfig:P={}}=e,W=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},r("orderForm-update-tp-sl","TP/SL price updating")),n.createElement(y,{brokerWidgetConfig:P,isLong:t,symbol:s,leverage:a,getI18n:r})),n.createElement("p",{className:"text-caption1 text-t-secondary"},r("orderForm-take-profit-price",{defaultValue:"Take Profit at {{takeProfitPrice}}",takeProfitPrice:(0,c.uf)((0,b.b)(p,N.cB.price),1)})),n.createElement(i.Z,{decorative:!0,className:"my-2"})),A="position"===F?await(0,d.a)(o,{address:E,abi:f.Z,functionName:"updateTradeTp",args:[m,p]}):await(0,d.a)(o,{address:E,abi:f.Z,functionName:"updateOrderTp",args:[m,p]}),L=await h.estimateContractGas(A.request),T=await(0,g.n)(o,{...A.request,gas:k(L)}),Z=(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(x,{getI18n:r})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});v?.(),await(0,u.e)(o,{hash:T,pollingInterval:w}),(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(C,{getI18n:r,brokerWidgetConfig:P})),{duration:I,dismissible:!0,id:Z,className:"border-support-success order-form-success-toast"})},S=async e=>{const{isLong:t,getI18n:r,leverage:a,symbol:s,config:o,stopLossParams:{hash:m,stopLossPrice:p},address:E,publicClient:h,onUserConfirm:v,updateType:F="position",brokerWidgetConfig:P={}}=e,W=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},r("orderForm-update-tp-sl","TP/SL price updating")),n.createElement(y,{brokerWidgetConfig:P,isLong:t,symbol:s,leverage:a,getI18n:r})),n.createElement("p",{className:"text-caption1 text-t-secondary"},p>0n?r("orderForm-stop-loss-price",{defaultValue:"Stop loss at {{stopLossPrice}}",stopLossPrice:(0,c.uf)((0,b.b)(p,N.cB.price),1)}):r("orderForm-remove-stop-loss-price","Remove stop loss")),n.createElement(i.Z,{decorative:!0,className:"my-2"})),A="position"===F?await(0,d.a)(o,{address:E,abi:f.Z,functionName:"updateTradeSl",args:[m,p]}):await(0,d.a)(o,{address:E,abi:f.Z,functionName:"updateOrderSl",args:[m,p]}),L=await h.estimateContractGas(A.request),T=await(0,g.n)(o,{...A.request,gas:k(L)}),Z=(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(x,{getI18n:r})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});v?.(),await(0,u.e)(o,{hash:T,pollingInterval:w}),(0,l.A)(n.createElement(n.Fragment,null,W,n.createElement(C,{getI18n:r,brokerWidgetConfig:P})),{duration:I,dismissible:!0,id:Z,className:"border-support-success order-form-success-toast"})},q=async e=>{const{isLong:t,getI18n:r,leverage:a,symbol:s,config:o,tpSlParams:{hash:m,stopLossPrice:p,takeProfitPrice:E},address:h,publicClient:v,onUserConfirm:F,updateType:P="position",brokerWidgetConfig:W={}}=e,A=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},r("orderForm-update-tp-sl","TP/SL price updating")),n.createElement(y,{brokerWidgetConfig:W,isLong:t,symbol:s,leverage:a,getI18n:r})),n.createElement("p",{className:"text-caption1 text-t-secondary"},r("orderForm-take-profit-price",{defaultValue:"Take Profit at {{takeProfitPrice}}",takeProfitPrice:(0,c.uf)((0,b.b)(E,N.cB.price),1)}),", ",p>0n?r("orderForm-stop-loss-price",{defaultValue:"Stop loss at {{stopLossPrice}}",stopLossPrice:(0,c.uf)((0,b.b)(p,N.cB.price),1)}):r("orderForm-remove-stop-loss-price","Remove stop loss")),n.createElement(i.Z,{decorative:!0,className:"my-2"})),L="position"===P?await(0,d.a)(o,{address:h,abi:f.Z,functionName:"updateTradeTpAndSl",args:[m,E,p]}):await(0,d.a)(o,{address:h,abi:f.Z,functionName:"updateOrderTpAndSl",args:[m,E,p]}),T=await v.estimateContractGas(L.request),Z=await(0,g.n)(o,{...L.request,gas:k(T)}),M=(0,l.A)(n.createElement(n.Fragment,null,A,n.createElement(x,{getI18n:r})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});F?.(),await(0,u.e)(o,{hash:Z,pollingInterval:w}),(0,l.A)(n.createElement(n.Fragment,null,A,n.createElement(C,{getI18n:r,brokerWidgetConfig:W})),{duration:I,dismissible:!0,id:M,className:"border-support-success order-form-success-toast"})},B=async e=>{const{brokerWidgetConfig:t={},config:r,predictAndBetParams:a,address:s,onUserConfirm:o,getI18n:c,publicClient:b}=e,N=n.createElement(n.Fragment,null,n.createElement("p",{className:"flex items-center gap-1.5 mb-1.5"},n.createElement("span",{className:"text-subtitle2 text-t-primary"},c("orderForm-dumb-order-placing","Placing Dumb Order")),n.createElement(y,{brokerWidgetConfig:t,isLong:a.isUp,getI18n:c})),n.createElement(i.Z,{decorative:!0,className:"my-2"})),P=a.tokenIn?await(0,d.a)(r,{address:s,abi:f.Z,functionName:"predictAndBet",args:[{...a,tokenIn:a.tokenIn}]}):await(0,d.a)(r,{address:s,abi:f.Z,functionName:"predictAndBetBNB",args:[{...a,tokenIn:"0x0000000000000000000000000000000000000000"}],value:a.amountIn}),W=await b.estimateContractGas(P.request),A=await(0,g.n)(r,{...P.request,gas:k(W)}),L=(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(x,{getI18n:c})),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});let T;o?.();try{T=await(0,u.e)(r,{hash:A,pollingInterval:w})}catch(e){return h.error(e),void(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(F,{getI18n:c,brokerWidgetConfig:t})),{duration:I,dismissible:!0,id:L,className:"border-support-error order-form-fail-toast"})}(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement("div",{className:"flex items-center gap-1"},n.createElement(E,{className:"w-5 h-5 text-t-link"}),n.createElement("p",{className:"flex text-t-secondary items-center gap-1 text-caption1 h-5"},c("orderForm-verify-oracle-price","Verifying Oracle price")))),{duration:1/0,id:L,dismissible:!1});const Z=T.logs.find((e=>"0x9327e597f77654c5259cbeff5340cbde86c469a7034ea15e5fa5b202ba0b474a"===e.topics[0]))?.topics[2],{promise:M,resolve:O,reject:S}=m(),q=(0,p.Y)(r,{abi:f.Z,address:s,eventName:"PredictAndBet",batch:!1,pollingInterval:w,onLogs(e){e.find((e=>e.topics[2]===Z))&&O()},onError(e){h.debug("PredictAndBet",e.message)}}),B=(0,p.Y)(r,{abi:f.Z,address:s,eventName:"PendingPredictionRefund",batch:!1,pollingInterval:w,onLogs(e){e.find((e=>e.topics[2]===Z))&&S()},onError(e){h.debug("PendingPredictionRefund",e.message)}});await Promise.race([M,v(3e4)]).then((()=>{(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(C,{getI18n:c,brokerWidgetConfig:t})),{duration:I,dismissible:!0,id:L,className:"border-support-success order-form-success-toast"})})).finally((()=>{q(),B()})).catch((e=>{h.error(e),(0,l.A)(n.createElement(n.Fragment,null,N,n.createElement(F,{getI18n:c,brokerWidgetConfig:t})),{duration:I,dismissible:!0,id:L,className:"border-support-error order-form-fail-toast"})}))},R=async e=>{const{hash:t,getI18n:r,config:a,brokerWidgetConfig:s={}}=e,o=(0,l.A)(n.createElement(x,{getI18n:r}),{duration:1/0,dismissible:!1,className:"order-form-wait-toast"});try{const e=await(0,u.e)(a,{hash:t,pollingInterval:w});return(0,l.A)(n.createElement(C,{getI18n:r,brokerWidgetConfig:s}),{duration:I,dismissible:!0,id:o,className:"border-support-success order-form-success-toast"}),e}catch(e){throw h.error(e),(0,l.A)(n.createElement(C,{getI18n:r,brokerWidgetConfig:s}),{duration:I,dismissible:!0,id:o,className:"border-support-success order-form-success-toast"}),e}}},42249:(e,t,r)=>{r.d(t,{h:()=>o});var a=r(13466),s=r(84400),n=r(95386);const o=()=>{const e=(0,a.x)();return(0,s.useMemo)((()=>n.yw[e]||{}),[e])}},44478:(e,t,r)=>{r.d(t,{O:()=>s,e:()=>a});const a={USD:"USD"},s={Classic:"Classic",Dumb:"Dumb"}},90471:(e,t,r)=>{r.d(t,{G:()=>o});var a=r(78659),s=r(57556),n=r(44478);const o=(0,s.Ue)()((e=>({tradeModeTab:a.C.getState().isDumbMode?n.O.Dumb:n.O.Classic,changeTradeModeTab:t=>{e((e=>({...e,tradeModeTab:t,useInfoTab:"orders"===e.useInfoTab&&"Dumb"===t?"positions":e.useInfoTab})))},useInfoTab:"positions",changeUserInfoTab:t=>{e((e=>({...e,useInfoTab:t})))}})))},89663:(e,t,r)=>{r.d(t,{XR:()=>d,fd:()=>i,rv:()=>n,uf:()=>o,yd:()=>l});var a=r(17921),s=r(12351);const n=r.n(s)()(((e,t)=>new RegExp(`\\d(?=(\\d{${t||3}})+${e>0?"\\.":"$"})`,"g")),((...e)=>e.join(","))),o=(e=0,t,r=3)=>{e="number"==typeof e?e:+e;const a=n(t,r);return e.toFixed(Math.max(0,~~t)).replace(a,"$&,")};function i(e,t=8){return new a.Z(e).decimalPlaces(t).toString()}function l(e,t,r=1){return new a.Z(e).toFixed(t,r)}const c=(e,t=2)=>{const r=String(e);if(0===t||r.length-r.indexOf(".")-1<t)return e.toFixed(t);const a=Number(e)||0,s=10**t;return Math.floor(a*s)/s};function m(e,t,r=!1){if(isNaN(e))return"NaN";if(void 0===t)return e;if(t<=0)return`${Math.floor(e)}`;if(r){const[r,a=""]=`${e}`.split(".");return`${r}.${a.slice(0,t).padEnd(t,"0")}`}return c(Number(e),t)}function d(e,t=2,r=!0){if(Math.abs(e)<1e-9&&Math.abs(e)>0)return`${e.toExponential(2)}`;if(Math.abs(e)<1e3)return m(e,t);const a=[{value:1,symbol:""},{value:1e3,symbol:"K"},{value:1e6,symbol:"M"},{value:1e9,symbol:"B"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];let s;for(s=a.length-1;s>0&&!(Math.abs(e)>=a[s].value);s--);return String(m(e/a[s].value,t,r)).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+a[s].symbol}},65413:(e,t,r)=>{r.d(t,{v:()=>s});var a=r(29697);function s(e,t){return(0,a.v)(String(e),t)}},83896:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(15510),s=r(84400),n=r(27618);const o=s.forwardRef((({className:e,orientation:t="horizontal",decorative:r=!0,...o},i)=>s.createElement(a.f,{ref:i,decorative:r,orientation:t,className:(0,n.cn)("shrink-0 bg-border-line","horizontal"===t?"h-px w-full":"h-full w-px",e),...o})));o.displayName=a.f.displayName},17845:(e,t,r)=>{r.d(t,{ee:()=>a});const a=new(r(58407).v)},73586:(e,t,r)=>{r.d(t,{n:()=>o});var a=r(13466),s=r(66632),n=r(84400);const o=e=>{const t=(0,a.x)();return(0,n.useMemo)((()=>Array.isArray(e)?e?.filter(Boolean).map((e=>({address:e,abi:s.Wo,chainId:t})))||[]:[{address:e,abi:s.Wo,chainId:t}]),[e,t])}},54872:(e,t,r)=>{r.d(t,{Z:()=>g});var a=r(67284),s=r(23011),n=r(79210),o=r(66632),i=r(63882),l=r(63925),c=r(84400),m=r(29376),d=r(73586);const g=(e,t)=>{const{address:r}=(0,m.E)(),{data:g,refetch:u,isFetched:p}=(e=>{const{isConnected:t,address:r}=(0,a.m)(),{address:n}=(0,m.E)(),[o]=(0,d.n)(e);return(0,s.u)({...o,functionName:"allowance",args:[r,n],query:{enabled:t&&Boolean(r)&&Boolean(e)}})})(e),{writeContractAsync:b,isPending:f}=(0,n.S)();return(0,c.useMemo)((()=>({amount:g,approve:async()=>b({address:e,abi:o.Wo,functionName:"approve",args:[r,i.zL]}),allowance:!!g&&0!==Number((0,l.d)(g)),isFetched:p,refetch:u,isPending:f})),[g,p,u,f,b,e,r])}}}]);