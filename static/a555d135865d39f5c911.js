"use strict";(self.webpackChunkcloud_onchain_trade_sdk=self.webpackChunkcloud_onchain_trade_sdk||[]).push([[9199],{72316:(e,t,r)=>{r.d(t,{n:()=>c});var n,o,a,s=r(29631),i=r(63469),l=r(59849);function c(){return(0,s.v9)((function(e){return e.setting.color})),i.Pe,[l.i,l.C]}e=r.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(c,"useSelector{color}",(function(){return[s.v9]})),(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&o.register(c,"useThemeScheme","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/hooks/useKlineTheme.js"),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&a(e)},37374:(e,t,r)=>{r.d(t,{Z:()=>c});var n,o=r(87866),a=r(24799),s=r.n(a);e=r.hmd(e),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var i={getUserInfo:function(){return(0,o.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})))()},getUserSettings:function(){return(0,o.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})))()},getSessionInfo:function(){return(0,o.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})))()},updateUserInfo:function(){return(0,o.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})))()},onUserInfoChange:function(){return(0,o.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})))()},updateUserSettings:function(){},onUserSettingsChange:function(){},onLogin:function(){},onLogout:function(){},login:function(){},register:function(){},onRefresh:function(){},registerActionHandle:function(){return function(){}},constants:{},onAppEvent:function(){},storage:{setItem:function(){return Promise.resolve()},getItem:function(){return Promise.resolve()},removeItem:function(){return Promise.resolve()},onStorageEvent:function(e){}}},l=i;const c=l;var u,d;(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(i,"service","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/electron.js"),u.register(l,"default","/Users/user/Documents/work/x-mono-benchmark/apps/cloud-onchain-trade-sdk/src/utils/electron.js")),(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&d(e)},52425:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(84400);function o(e){const t=(0,n.useRef)(e);t.current=e;const r=(0,n.useCallback)(((...e)=>("function"==typeof t.current?t.current:()=>{})(...e)),[]);return"function"==typeof e?r:e}},89663:(e,t,r)=>{r.d(t,{XR:()=>d,fd:()=>i,rv:()=>a,uf:()=>s,yd:()=>l});var n=r(17921),o=r(12351);const a=r.n(o)()(((e,t)=>new RegExp(`\\d(?=(\\d{${t||3}})+${e>0?"\\.":"$"})`,"g")),((...e)=>e.join(","))),s=(e=0,t,r=3)=>{e="number"==typeof e?e:+e;const n=a(t,r);return e.toFixed(Math.max(0,~~t)).replace(n,"$&,")};function i(e,t=8){return new n.Z(e).decimalPlaces(t).toString()}function l(e,t,r=1){return new n.Z(e).toFixed(t,r)}const c=(e,t=2)=>{const r=String(e);if(0===t||r.length-r.indexOf(".")-1<t)return e.toFixed(t);const n=Number(e)||0,o=10**t;return Math.floor(n*o)/o};function u(e,t,r=!1){if(isNaN(e))return"NaN";if(void 0===t)return e;if(t<=0)return`${Math.floor(e)}`;if(r){const[r,n=""]=`${e}`.split(".");return`${r}.${n.slice(0,t).padEnd(t,"0")}`}return c(Number(e),t)}function d(e,t=2,r=!0){if(Math.abs(e)<1e-9&&Math.abs(e)>0)return`${e.toExponential(2)}`;if(Math.abs(e)<1e3)return u(e,t);const n=[{value:1,symbol:""},{value:1e3,symbol:"K"},{value:1e6,symbol:"M"},{value:1e9,symbol:"B"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];let o;for(o=n.length-1;o>0&&!(Math.abs(e)>=n[o].value);o--);return String(u(e/n[o].value,t,r)).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n[o].symbol}},62910:(e,t,r)=>{r.d(t,{$:()=>s});var n=r(84400),o=r(27618);const a=({delay:e,color:t})=>n.createElement("div",{className:"h-full w-[3px] animate-spinner",style:{animationDelay:e,backgroundColor:t}}),s=(0,n.forwardRef)((({color:e="rgb(var(--colors-interactive-primary))",className:t,...r},s)=>{const i=[.5,.2,.2,.5].map((e=>`-${e}s`));return n.createElement("div",{className:(0,o.cn)("spinner flex w-[30px] h-[30px] items-center justify-between",t),ref:s,...r},i.map(((t,r)=>n.createElement(a,{key:r,delay:t,color:e}))))}));s.displayName="Spinner"},49199:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Wt});var n=r(10322),o=r(84400);const a=o.createContext({});var s=r(78659),i=r(11273),l=r(73656);const c="chart_futures",u={"1s":"1S","1m":"1","3m":"3","5m":"5","15m":"15","30m":"30","1h":"60","2h":"120","4h":"240","6h":"360","8h":"480","12h":"720","1d":"1D","3d":"3D","1w":"1W","1M":"1M"},d=["dont_show_boolean_study_arguments","hide_last_na_study_output","left_toolbar","save_chart_properties_to_local_storage","compare_symbol","snapshot_trading_drawings"],m=["header_widget","header_symbol_search","symbol_info","header_compare","header_chart_type","display_market_status","symbol_search_hot_key","border_around_the_chart","remove_library_container_border","symbol_info","header_interval_dialog_button","show_interval_dialog_on_key_press","volume_force_overlay","header_resolutions","legend_context_menu"];var p;!function(e){e[e.Bars=0]="Bars",e[e.Candles=1]="Candles",e[e.Line=2]="Line",e[e.Area=3]="Area",e[e.Renko=4]="Renko",e[e.Kagi=5]="Kagi",e[e.PointAndFigure=6]="PointAndFigure",e[e.LineBreak=7]="LineBreak",e[e.HeikenAshi=8]="HeikenAshi",e[e.HollowCandles=9]="HollowCandles",e[e.Baseline=10]="Baseline",e[e.HiLo=12]="HiLo",e[e.Column=13]="Column",e[e.LineWithMarkers=14]="LineWithMarkers",e[e.Stepline=15]="Stepline",e[e.HLCArea=16]="HLCArea"}(p||(p={}));const h=({resetErrorBoundary:e,mainText:t,btnText:r})=>o.createElement("div",{className:"flex w-full h-full flex-col items-center justify-center"},o.createElement("div",{className:"text-xl text-t-primary"},t),o.createElement("div",{className:"text-sm underline cursor-pointer text-t-link mt-3",onClick:e},r));var y=r(77179),f=r.n(y),g=r(62910);const b=()=>o.createElement("div",{className:"absolute top-0 left-0 w-full h-full flex justify-center items-center z-[100]"},o.createElement(g.$,{className:"z-[100]"})),v={};var S=r(1085),C=r(38270);const _=["--colors-interactive-primary","--colors-background-bg1","--colors-interactive-primaryHover","--colors-t-primary","--colors-interactive-primaryActive","--colors-interactive-interactiveBg","--colors-interactive-interactiveBgHover","--colors-interactive-interactiveBgSelected","--colors-interactive-sell","--colors-interactive-buy","--colors-border-line","--colors-t-placeholder","--colors-interactive-interactiveBgHover","--colors-t-third"],w=e=>{const t=window.getComputedStyle(document.documentElement);_.forEach((r=>{e?.setCSSCustomProperty?.(r,t.getPropertyValue(r))}))},T=({widget:e,seriesStyle:t})=>{e.applyOverrides({"mainSeriesProperties.style":t})},k=(e,t)=>{const[r]=/(#\w+)/g.exec(e)||[];return r?((e,t)=>{const r=e.replace("#","");return`rgba(${parseInt(r.substring(0,2),16)},${parseInt(r.substring(2,4),16)},${parseInt(r.substring(4,6),16)},${t})`})(r,t):e},E=async({widget:e,theme:t,styles:r,onSave:n=(()=>null),onSetThemeDone:o})=>(await(({widget:e,theme:t})=>{const r=e.chart().getCheckableActionState("showCountdown");return e.changeTheme(t,{disableUndo:!0}),r?new Promise((t=>{setTimeout((()=>{e.chart().executeActionById("showCountdown"),t()}),0)})):Promise.resolve()})({widget:e,theme:t}),new Promise((t=>{setTimeout((()=>{e.applyOverrides(r.overrides),(({widget:e,styles:t})=>{try{const r=e.activeChart().getAllStudies().find((e=>"volume"===e?.name?.toLowerCase()));r&&e.activeChart().getStudyById(r.id).applyOverrides({"volume.color.0":k(t.overrides["candleStyle.downColor"],.5),"volume.color.1":k(t.overrides["candleStyle.upColor"],.5)})}catch(e){}})({widget:e,styles:r}),e.save(n),o?.(),t()}),0)}))),I=({symbol:e,symbolsInfo:t={},interval:r,theme:n,styles:a,limitOrders:s=[],positionOrders:i=[],executionOrders:l=[],seriesStyle:c,showIndicators:u,isChartReady:p,overwritingThemeOnLoaded:h=!1,widget:y,initialConfig:{tvConfig:g,onSave:b,onCreateOrderShapesError:_,onLoadConfig:k=(()=>Promise.resolve(null)),onLoading:I,onWidgetInitialized:x,onChartReadyDone:P,onChartReadyError:R,onWillUnmount:D,onWidgetRefNotFoundError:L,onScriptLoaded:M,onScriptLoadingError:A,onFirstTimeSetThemeDone:B,onSetThemeDone:$,onFirstTimeDataLoadedDone:N,onDataLoadedDone:V,onTradingViewInitError:H,onVisibleRangeChanged:O,onSymbolWillChange:z,onSymbolChanged:G,onIntervalChanged:U,onInitStudies:W}})=>{const[F,Z]=(0,o.useState)(0),j=(0,o.useCallback)((()=>Z((e=>e+1))),[Z]),Q=(0,o.useRef)([]),K=(0,o.useRef)([]),q=(0,o.useRef)([]),Y=(0,o.useRef)(),J=(0,o.useRef)(e),X=(0,o.useRef)(t),ee=(0,o.useRef)(n),te=(0,o.useRef)(a),re=(0,o.useRef)(h),ne=g.container_id;(0,o.useEffect)((()=>{ee.current=n}),[n]),(0,o.useEffect)((()=>{te.current=a}),[a]),(0,o.useEffect)((()=>{re.current=h}),[h]),(0,o.useEffect)((()=>{J.current=e}),[e]),(0,o.useEffect)((()=>{X.current=t}),[t]);const oe=(0,o.useCallback)((()=>{Y.current&&(({widget:e,onSave:t=(()=>Promise.resolve())})=>{e.save(t)})({widget:Y.current,onSave:b})}),[b]),ae=(0,o.useCallback)((e=>{if(!Y.current||!e)return;const t=Y.current.activeChart().getStudyById(e),r=J.current,n=X.current[r],{tickSize:o=100}=n||{},a=Math.log10(o);t?.applyOverrides({precision:a})}),[]),se=(0,o.useCallback)((()=>{Y.current&&Y.current.activeChart().getAllStudies().filter((({name:e})=>"Volume"!==e)).forEach((({id:e})=>ae(e)))}),[ae]),ie=(0,o.useCallback)((()=>{setTimeout((()=>{if(!Y.current)return;const e=Y.current.activeChart().getAllStudies();ae(e[0]?.id),oe()}),0)}),[ae,oe]),le=(0,o.useCallback)((()=>{I?.(!0),G?.(),se()}),[se,I,G]),ce=(0,o.useCallback)((e=>{I?.(!0),U?.(e)}),[U,I]),ue=(0,o.useCallback)((()=>{I?.(!1),j(),N?.(),se()}),[se,j,N,I]),de=(0,o.useCallback)((()=>{I?.(!1),j(),V?.()}),[j,V,I]),me=(0,o.useCallback)((({from:e,to:t})=>{O?.({startTime:1e3*e,endTime:1e3*t})}),[O]),pe=(0,o.useCallback)((async()=>{M?.();const e=await k(),t=(({tradingViewSave:e,styles:t},{symbol:r,interval:n,theme:o="Dark",library_path:a,custom_css_url:s="./themed.css",locale:i="en",overrides:l,debug:c=!1,time_frames:u=[],autosize:p=!0,toolbar_bg:h="transparent",studies_overrides:y,loading_screen:g,enabled_features:b=d,disabled_features:v=m,...S})=>{let C="Asia/Shanghai";try{C=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}const _=f()(e);if(_)for(let e=0;e<_.charts[0].panes.length;e++)_.charts[0].panes[e].sources[0].state.symbol=r,_.charts[0].panes[e].sources[0].state.interval=n;return{...S,symbol:r,interval:n,timezone:C,theme:o,library_path:a,custom_css_url:s,locale:i,overrides:l,debug:c,time_frames:u,autosize:p,toolbar_bg:h,studies_overrides:y,loading_screen:g||{backgroundColor:t.overrides["paneProperties.background"]},enabled_features:b,disabled_features:v,saved_data:_||void 0}})({tradingViewSave:e,styles:a},g);try{Y.current=new window.TradingView.widget(t),x?.(),Y.current?.onChartReady((async()=>{if(!Y.current)return L?.();try{w(Y.current),Y.current.subscribe("onAutoSaveNeeded",oe),Y.current.subscribe("study",ie),Y.current.chart().onDataLoaded().subscribe(null,ue,!0),Y.current.chart().onDataLoaded().subscribe(null,de),Y.current.chart().onSymbolChanged().subscribe(null,le),Y.current.chart().onVisibleRangeChanged().subscribe(null,me),Y.current.chart().onIntervalChanged().subscribe(null,ce),await(async({tradingViewSave:e,theme:t,styles:r,seriesStyle:n,widget:o,onInitStudies:a})=>{await(async({tradingViewSave:e,widget:t,theme:r,styles:n})=>{if(e)return Promise.resolve();await E({widget:t,theme:r,styles:n})})({widget:o,tradingViewSave:e,theme:t,styles:r}),a?.({tradingViewSave:e,widget:o}),T({widget:o,seriesStyle:n})})({tradingViewSave:e,theme:n,styles:a,seriesStyle:c,widget:Y.current,onInitStudies:W}),re.current&&await E({widget:Y.current,theme:ee.current,styles:te.current,onSave:b,onSetThemeDone:B}),setTimeout(se,0),P?.()}catch(e){R?.(e)}}))}catch(e){H?.(e)}}),[]),he=function(e,t){const[r,n]=(0,o.useState)((()=>{var r;return!e||(null==t?void 0:t.shouldPreventLoad)?"idle":"undefined"==typeof window?"loading":null!==(r=v[e])&&void 0!==r?r:"loading"}));return(0,o.useEffect)((()=>{var r,o;if(!e||(null==t?void 0:t.shouldPreventLoad))return;const a=v[e];if("ready"===a||"error"===a)return void n(a);const s=function(e){const t=document.querySelector(`script[src="${e}"]`),r=null==t?void 0:t.getAttribute("data-status");return{node:t,status:r}}(e);let i=s.node;if(i)n(null!==(o=null!==(r=s.status)&&void 0!==r?r:a)&&void 0!==o?o:"loading");else{if(i=document.createElement("script"),i.src=e,i.async=!0,null==t?void 0:t.attributes)for(const e in t.attributes)Object.prototype.hasOwnProperty.call(t.attributes,e)&&i.setAttribute(e,t.attributes[e]);i.setAttribute("data-status","loading"),document.body.appendChild(i);const r=e=>{const t="load"===e.type?"ready":"error";null==i||i.setAttribute("data-status",t)};i.addEventListener("load",r),i.addEventListener("error",r)}const l=t=>{const r="load"===t.type?"ready":"error";n(r),v[e]=r};return i.addEventListener("load",l),i.addEventListener("error",l),()=>{i&&(i.removeEventListener("load",l),i.removeEventListener("error",l)),i&&(null==t?void 0:t.removeOnUnmount)&&i.remove()}}),[e,null==t?void 0:t.shouldPreventLoad,null==t?void 0:t.removeOnUnmount,null==t?void 0:t.attributes]),r}(`${g.library_path}charting_library.js?v=1`,{removeOnUnmount:!1});return(0,o.useEffect)((()=>{"ready"!==he?"error"===he&&A?.(new Error("Cannot loading trading view")):pe()}),[pe,A,he]),(0,S.Z)((()=>{Y.current&&(Y.current?.remove(),Y.current=void 0,D?.())})),(0,C.Z)((()=>{if(0!==F&&Y.current)try{Q.current?.forEach((e=>e.remove())),Q.current=(({widget:e,shapes:t,styles:r})=>t.map((t=>(({widget:e,order:{id:t,text:r,price:n,quantity:o,isBuy:a,tooltip:s="",modifyTooltip:i="",cancelTooltip:l="",editable:c,onMove:u,onModify:d,onCancel:m},styles:p})=>{const h=a?p.originalTheme?.colors?.buy:p.originalTheme?.colors?.sell,y=e.chart().createOrderLine({}).setText(r).setPrice(n).setQuantity(o).setTooltip(s).setModifyTooltip(i).setCancelTooltip(l).setEditable(c).setExtendLeft(!1).setLineLength(65).setLineStyle(2).setLineColor(h).setBodyFont("normal 14pt Verdana").setQuantityFont("normal 14pt Verdana").setBodyBorderColor(h).setBodyBackgroundColor(h).setBodyTextColor(p.originalTheme?.colors?.t?.primary).setQuantityBorderColor(p.originalTheme?.colors?.line).setQuantityBackgroundColor(p.originalTheme?.colors?.popupBg).setQuantityTextColor(p.originalTheme?.colors?.t?.secondary).setCancelButtonBorderColor(p.originalTheme?.colors?.line).setCancelButtonBackgroundColor(p.originalTheme?.colors?.popupBg).setCancelButtonIconColor(p.originalTheme?.colors?.t?.secondary);return y.onModify((()=>d({id:t,text:y.getText(),price:y.getPrice(),quantity:y.getQuantity()}))).onMove((()=>u({id:t,text:y.getText(),price:y.getPrice(),quantity:y.getQuantity()}))).onCancel((()=>m({id:t,text:y.getText(),price:y.getPrice(),quantity:y.getQuantity()}))),y})({widget:e,order:t,styles:r}))))({widget:Y.current,styles:a,shapes:s})}catch(e){_?.(e)}}),[F,s,a]),(0,C.Z)((()=>{if(0!==F&&Y.current)try{K.current?.forEach((e=>e.remove())),K.current=(({widget:e,shapes:t,styles:r})=>t.map((t=>(({widget:e,position:{text:t,price:r,PNL:n,quantity:o,tooltip:a},styles:s})=>{const i=+o>0?s.originalTheme?.colors?.buy:s.originalTheme?.colors?.sell,l=n>0?s.originalTheme?.colors?.buy:n<0?s.originalTheme?.colors?.sell:i;return e.chart().createPositionLine({}).setText(t).setPrice(r).setQuantity(o).setTooltip(a).setExtendLeft(!1).setLineLength(100).setLineStyle(2).setLineColor(l).setBodyFont("normal 14pt Verdana").setQuantityFont("normal 14pt Verdana").setBodyBorderColor(l).setBodyBackgroundColor(l).setBodyTextColor(s.originalTheme?.colors?.t?.primary).setQuantityBorderColor(i).setQuantityBackgroundColor(s.originalTheme?.colors?.popupBg).setQuantityTextColor(s.originalTheme?.colors?.t?.primary)})({widget:e,position:t,styles:r}))))({widget:Y.current,styles:a,shapes:i})}catch(e){_?.(e)}}),[F,i,a]),(0,C.Z)((()=>{if(0!==F&&Y.current)try{q.current?.forEach((e=>e.remove())),q.current=(({widget:e,shapes:t,styles:r})=>t.map((t=>(({widget:e,executionShape:{price:t,time:r,text:n,tooltip:o,isBuy:a},styles:s})=>{const i=a?s.originalTheme?.colors?.buy:s.originalTheme?.colors?.sell;return e.chart().createExecutionShape({}).setPrice(t).setTime(r).setDirection(a?"buy":"sell").setText(n).setTooltip(o).setArrowHeight(8).setArrowSpacing(1).setArrowColor(i).setTextColor(s.originalTheme?.colors?.t?.primary).setFont("normal 14pt Verdana")})({widget:e,executionShape:t,styles:r}))))({widget:Y.current,styles:a,shapes:l})}catch(e){_?.(e)}}),[F,l,a]),(0,C.Z)((()=>{p&&Y.current&&T({widget:Y.current,seriesStyle:c})}),[c]),(0,C.Z)((()=>{p&&Y.current&&z?.(e)}),[p,z,e]),(0,C.Z)((()=>{p&&Y.current&&(({widget:e,symbol:t,interval:r,onDone:n=(()=>null)})=>{e.setSymbol(t,r,(()=>{e.activeChart().symbol()!==t?e.setSymbol(t,r,n):n()}))})({widget:Y.current,symbol:e,interval:r})}),[e,r]),(0,o.useEffect)((()=>{p&&Y.current&&(w(Y.current),E({widget:Y.current,theme:n,styles:a,onSetThemeDone:$,onSave:b}))}),[ne,p,n,a,b,$]),(0,C.Z)((()=>{p&&Y.current&&(e=>{e.chart().executeActionById("insertIndicator")})(Y.current)}),[u]),(0,o.useImperativeHandle)(y,(()=>Y.current)),o.createElement("div",{id:g.container_id,className:"h-full"})},x=e=>{const[t,r]=(0,o.useState)(!1),n=(0,o.useMemo)((()=>f()(e.initialConfig)),[]),a=(0,o.useCallback)((()=>{r(!0),n.onChartReadyDone?.()}),[n]),s=(0,o.useMemo)((()=>({...e,isChartReady:t,initialConfig:{...n,onChartReadyDone:a}})),[n,t,a,e]);return o.createElement("div",{className:"h-full relative"},o.createElement(I,{...s}),!t&&o.createElement("div",{className:"h-full w-full absolute left-0 top-0",style:{background:e.styles.overrides["paneProperties.background"]}},o.createElement(b,null)))};var P=r(4231),R=r(79542),D=r(6921),L=r(59712);const M=({error:e,resetErrorBoundary:t})=>{const r=(0,o.useCallback)((e=>{e.preventDefault(),t()}),[t]);return o.createElement(P.bZ,{variant:"destructive"},o.createElement(P.Cd,{className:"mb-2 leading-5"},"Sorry, There is an error happening. Please refresh the page."," ",o.createElement("button",{type:"button",onClick:r,className:"text-t-link hover:text-t-linkHover"},"Reset Here")),o.createElement(P.X,{className:"text-body2 flex flex-col gap-2"},o.createElement("p",null,"If this keep happening please contract our support for help."),o.createElement("p",null,"Error Details:"),o.createElement("pre",{className:"text-caption2 text-t-third break-all"},e.message)))},A=e=>{const t=(0,o.useCallback)(((e,t)=>{L.log(t.componentStack),R.Tb(e)}),[]);return o.createElement(D.SV,{FallbackComponent:M,onError:t,...e})};A.displayName="ErrorBoundary";const B=A;var $=r(52425),N=r(1960),V=r(9704),H=r(87608),O=r.n(H),z=r(83680),G=r.n(z),U=r(39378),W=r(47909),F=r(59712);const Z=e=>{switch(e){case"index":return"ipTradingView";case"mark":return"mpTradingView";default:return"myTradingView"}},j=async(e,t)=>{[c].map((e=>G().createInstance({name:e}))).forEach((r=>r.setItem(t,e)))},Q=({symbol:e,namespace:t,hidden:r,datafeed:n,storage:i,hideToolbarDefault:c=!1})=>{const{chartRef:m,useTheme:y,useLng:f,trackGAEvent:g,getI18n:b,logOnChartReady:v,logOnChartResponsive:S,useIntervalStore:C,useChartTypeStore:_,useTvChartStyleStore:w,useIfShowTVIndicatorsMenu:T,usePriceTypeStore:k,useLoadingStore:E,TRADINGVIEW_STATIC_PATH:I,TRADING_VIEW_STATIC_BASE_URL:P,usePositionLine:R,useOrderLine:D}=(0,o.useContext)(a),{isDumbMode:L}=(0,s.C)(),M=(0,o.useRef)(),{theme:A}=y(),B=(0,o.useRef)(-1),[H,z]=(0,o.useState)(!1),{positionLines:G}=R({symbol:e,namespace:t}),{orderLines:Q}=D({symbol:e,namespace:t}),[K,q]=C(),[Y]=k(),[,J]=E(),X=T(),[ee]=w(),[te]=_(),re=te===V.oX.Line||L?p.Line:ee,ne=L?u["1s"]:u["1s"===K?"5m":K],oe=Z(Y),ae=(({chartRef:e,onReadyCallback:t})=>{const r=(0,o.useRef)(!1),{isDumbMode:n}=(0,s.C)();return(0,o.useCallback)((()=>{r.current=!0,t?.(e.current),e?.current?.headerReady().then((()=>{n&&(e.current.createButton().textContent="1s")}))}),[e,n,t])})({onReadyCallback:v,chartRef:M,interval:ne}),{brokerName:se,customCSSUrl:ie}=(0,W.z)();m&&(m.current=M.current);const le=(0,o.useCallback)((()=>{try{M.current?.chart().refreshMarks()}catch(e){F.warn("try to refreshMarks error")}}),[]);(0,N.x)({onBlockNumber(e){F.debug("new block",e,"try to refresh markers"),le()},pollingInterval:3e4});const ce=(0,o.useMemo)((()=>`${t}-tradingview_${oe}_${A}`),[t,oe,A]),ue=(de=f(),l.electron?function(e){return{cn:"zh",kr:"ko",tw:"zh_TW",vn:"vi",tr:"tr",ru:"ru",es:"es",ro:"ro",cs:"cs",fr:"fr",de:"de",pt:"pt",it:"it",pl:"pl",nl:"nl_NL",id:"id",ja:"ja"}[e]||"en"}(de):function(e){switch(e){case"zh-CN":return"zh";case"zh-HK":case"zh-TW":return"zh_TW";case"ja":return"ja";case"ko":return"ko";case"th":return"th";case"he":return"he_IL";case"ru":return"ru";case"cs":return"cs";case"sv":return"sv";case"vi":return"vi";case"tr":return"tr";case"ro":return"ro";case"pt-PT":case"pt-BR":case"pt":return"pt";case"pl":return"pl";case"nl":return"nl_NL";case"it":return"it";case"fr":return"fr";case"es":case"es-LA":return"es";case"de":return"de";case"id":return"id_ID";default:return"en"}}(de));var de;const me=(0,o.useMemo)((()=>{const e=e=>e.startsWith("#")?e:`#${Array.from(e.matchAll(/(\d{1,3})/g)).map((([e])=>{const t=Number(e).toString(16);return 1===t.length?`0${t}`:t})).join("")}`,t=window.getComputedStyle(document.documentElement),r=e(t.getPropertyValue("--colors-interactive-buy")),n=e(t.getPropertyValue("--colors-interactive-sell")),o=e(t.getPropertyValue("--colors-background-bg1")),a="astherus"===se?`${e(t.getPropertyValue("--colors-border-line"))}80`:e(t.getPropertyValue("--colors-border-lineSubtle"));return{overrides:{volumePaneSize:"medium","symbolWatermarkProperties.transparency":85,"symbolWatermarkProperties.color":"rgba(0, 0, 0, 0)","scalesProperties.textColor":e(t.getPropertyValue("--colors-t-third")),"scalesProperties.lineColor":e(t.getPropertyValue("--colors-border-line")),"scalesProperties.backgroundColor":o,"paneProperties.backgroundType":"solid","paneProperties.background":o,"paneProperties.legendProperties.showSeriesTitle":!1,"paneProperties.horzGridProperties.color":a,"paneProperties.vertGridProperties.color":a,"paneProperties.crossHairProperties.color":e(t.getPropertyValue("--colors-t-third")),"candleStyle.upColor":r,"candleStyle.downColor":n,"candleStyle.drawWick":!0,"candleStyle.drawBorder":!0,"candleStyle.borderColor":"transparent","candleStyle.borderUpColor":r,"candleStyle.borderDownColor":n,"candleStyle.wickUpColor":r,"candleStyle.wickDownColor":n,"hollowCandleStyle.upColor":r,"hollowCandleStyle.downColor":n,"hollowCandleStyle.drawWick":!0,"hollowCandleStyle.drawBorder":!0,"hollowCandleStyle.borderColor":"transparent","hollowCandleStyle.borderUpColor":r,"hollowCandleStyle.borderDownColor":n,"hollowCandleStyle.wickUpColor":r,"hollowCandleStyle.wickDownColor":n,"haStyle.upColor":r,"haStyle.downColor":n,"haStyle.drawWick":!0,"haStyle.drawBorder":!0,"haStyle.borderColor":"transparent","haStyle.borderUpColor":r,"haStyle.borderDownColor":n,"haStyle.wickUpColor":r,"haStyle.wickDownColor":n,"barStyle.upColor":r,"barStyle.downColor":n,"areaStyle.color1":r,"areaStyle.color2":n,"areaStyle.linecolor":n,"baselineStyle.baselineColor":r,"baselineStyle.topFillColor1":r,"baselineStyle.topFillColor2":n,"baselineStyle.bottomFillColor1":r,"baselineStyle.bottomFillColor2":n,"baselineStyle.topLineColor":r,"baselineStyle.bottomLineColor":n}}}),[A]),pe=(0,o.useMemo)((()=>b("trd-chart-tv-load-timeout",{defaultValue:"Failed to load TradingView due to network issues."})||""),[b]),he=(0,o.useMemo)((()=>b("trd-chart-crash-reload",{defaultValue:"Reload"})||""),[b]),ye=(0,o.useCallback)((()=>window.location.reload()),[]),fe=(0,o.useCallback)((()=>{B.current=Date.now()}),[]),ge=(0,o.useCallback)((()=>i.getItem(oe)),[i,oe]),be=(0,o.useCallback)((e=>{q((0,U.invert)(u)[e])}),[q]),ve=(0,o.useCallback)((async e=>j(e,oe)),[oe]),Se=(0,$.D)((e=>J(e))),Ce=(0,o.useCallback)((()=>n.setContainerId?.(ce)),[n,ce]),_e=(0,o.useCallback)((async()=>{const e=await i.getItem(oe);j(e,oe),n.unsubscribe()}),[i,n,oe]),we=(0,o.useCallback)((e=>F.log(JSON.stringify({type:"tv-error",error:e}),"custom")),[]),Te=(0,o.useCallback)((()=>{g("trd_chart_tv_download_timeout",{user_network:JSON.stringify(navigator.connection)}),z(!0)}),[g]),ke=(0,o.useCallback)((()=>S(B.current)),[S]),Ee=(0,o.useMemo)((()=>["create_volume_indicator_by_default","create_volume_indicator_by_default_once","header_symbol_search","header_compare","symbol_search_hot_key","border_around_the_chart","timezone_menu","go_to_date","main_series_scale_menu","timeframes_toolbar","show_interval_dialog_on_key_press"].concat(L?["header_resolutions","header_chart_type","header_undo_redo"]:[])),[L]),Ie=P||(I?`/${I}/charting_library_26/`:"charting_library_26/");return H?o.createElement(h,{mainText:pe,btnText:he,resetErrorBoundary:ye}):o.createElement("div",{className:O()("h-full p-px [&_iframe]:rounded-lg",r?"hidden":"block")},o.createElement(x,{widget:M,symbol:e,interval:ne,theme:A,styles:me,limitOrders:Q,positionOrders:G,showIndicators:X,seriesStyle:re,initialConfig:{tvConfig:{overrides:me.overrides,container_id:ce,container:ce,backgroundColor:"rgba(255, 0, 0, 1)",library_path:Ie,custom_css_url:ie??"custom_css.css?v=0.03",symbol:e,interval:ne,theme:A,locale:ue,datafeed:n,disabled_features:Ee,enabled_features:[...d,c&&"hide_left_toolbar_by_default",L&&"seconds_resolution","hide_left_toolbar_by_default","iframe_loading_compatibility_mode"].filter(Boolean),favorites:{intervals:L?["1S"]:["1","5","15","60","240","1D"],chartTypes:L?["Line"]:["Candles","Line"]}},onIntervalChanged:be,onScriptLoaded:fe,onLoadConfig:ge,onSave:ve,onLoading:Se,onWidgetInitialized:Ce,onChartReadyDone:ae,onWillUnmount:_e,onCreateOrderShapesError:we,onScriptLoadingError:Te,onFirstTimeDataLoadedDone:ke}}))},K=e=>{const{getI18n:t,usePriceTypeStore:r}=(0,o.useContext)(a),[n]=r(),s=Z(n),i=(0,o.useMemo)((()=>t("trd-chart-crash-info",{defaultValue:"Something is wrong with the chart."})||""),[t]),l=(0,o.useMemo)((()=>t("trd-chart-crash-refresh",{defaultValue:"Refresh"})||""),[t]),c=(0,o.useCallback)((()=>e.storage.removeItem(s)),[e.storage,s]),u=(0,o.useCallback)(((e,t)=>{F.log(JSON.stringify({type:"trading_view",error:e,componentStack:t}),"custom")}),[]);return o.createElement(B,{name:"trading_view",FallbackComponent:({resetErrorBoundary:e})=>o.createElement(h,{mainText:i,btnText:l,resetErrorBoundary:e}),onReset:c,onError:u},o.createElement(Q,{...e}))},q=({symbol:e,namespace:t})=>{const{chartRef:r,storage:n,useIntervalStore:l,useCreateDatafeed:c,useAllProduct:u}=(0,o.useContext)(a),{isDumbMode:d}=(0,s.C)(),{isMobile:m}=(0,i.F)(),[p,h]=(0,o.useState)(1),y=(0,o.useRef)(!0),[f,g]=(0,o.useState)(0),[b,v]=(0,o.useState)(!1),[S]=l(),C=u()[e],{pair:_="",tickSize:w=""}=C||{};(0,o.useEffect)((()=>{const e=()=>{g(Date.now()),h((e=>-1*e))};return window.addEventListener("online",e),()=>{window.removeEventListener("online",e)}}),[]),(0,o.useEffect)((()=>{y.current=!1,b&&v(!1)}),[]);const T=c({symbol:e,namespace:t,chartRef:r,contractType:"PERPETUAL",reconnectTVTimes:f,TICK_SIZE:.01,reloadTV:h});return e&&S&&_?o.createElement(K,{key:`tv-${d?"dumb":"perp"}-${p}`,chartRef:r,symbol:e,storage:n,namespace:t,datafeed:T,tickSize:w,hidden:!1,hideToolbarDefault:m}):null};function Y(){const{symbol:e,namespace:t}=(0,o.useContext)(a);return o.createElement(q,{symbol:e,namespace:t})}const J=e=>{const t=(0,o.useRef)();return(0,o.useMemo)((()=>o.createElement(a.Provider,{value:{chartRef:t,getI18n:e.getI18n,useLng:e.useLng,symbol:e.symbol,namespace:e.namespace,storage:e.storage,STATIC_HOST:e.STATIC_HOST,TRADINGVIEW_STATIC_PATH:e.TRADINGVIEW_STATIC_PATH,TRADING_VIEW_STATIC_BASE_URL:e.TRADING_VIEW_STATIC_BASE_URL,showLoading:e.showLoading,electron:e.electron,useThemeScheme:e.useThemeScheme,trackGAEvent:e.trackGAEvent,logOnChartReady:e.logOnChartReady,logOnChartResponsive:e.logOnChartResponsive,useOrderLine:e.useOrderLine,usePositionLine:e.usePositionLine,useTheme:e.useTheme,useAllProduct:e.useAllProduct,useLoadingStore:e.useLoadingStore,useTvChartStyleStore:e.useTvChartStyleStore,useIfShowTVIndicatorsMenu:e.useIfShowTVIndicatorsMenu,useIntervalConfigStore:e.useIntervalConfigStore,useIntervalStore:e.useIntervalStore,useSelectedIntervalsStore:e.useSelectedIntervalsStore,useIsEditingIntervalStore:e.useIsEditingIntervalStore,usePriceTypeStore:e.usePriceTypeStore,useChartTypeStore:e.useChartTypeStore,useCreateDatafeed:e.useCreateDatafeed}},o.createElement(Y,null))),[e])};var X=r(33687),ee=r(39671),te=r(85177);const re=e=>[e.interval,e.setInterval],ne=e=>[e.chartType,e.setChartType],oe=e=>[e.loading,e.setLoading],ae=e=>[e.selectedIntervals,e.setSelectedIntervals],se=e=>[e.tvChartStyle,e.setTvChartStyle],ie=e=>[e.isOpen,e.setIsOpen],le=e=>[e.isEditing,e.setIsEditing],ce=e=>[e.priceType,e.setPriceType],ue=e=>e.loading,de=e=>e.ifShowIndicatorsMenu,me=e=>e.toggleTVIndicatorsMenu;var pe=r(72316),he=r(34254),ye=r(52590),fe=r(37374),ge=r(43785),be=r(87354),ve=r(14369),Se=r(24722);const Ce=()=>{const{data:e}=(0,Se.S)(),{data:t}=(0,ve.R)(),{productMap:r}=(0,te.GS)(),n=(0,o.useMemo)((()=>(e||[]).map((e=>e.name.replace(/\//,"")))),[e]),a=(0,o.useMemo)((()=>t?.map((e=>e.name.replace(/\//,"")))??[]),[t]);return(0,o.useMemo)((()=>Object.keys(r).filter((e=>n.concat(a).flat()?.includes(e))).reduce(((e,t)=>(e[t]=r[t],e)),{})),[r,n,a])};var _e=r(85125);const we=e=>()=>(0,te.v5)(e)(oe),Te=e=>()=>(0,te.OL)(e)(se),ke=e=>()=>(0,te.BD)(e)(de),Ee=e=>()=>(0,te.BD)(e)(me),Ie=e=>()=>(0,te.WH)(e)(ie),xe=e=>()=>(0,te.Qy)(e)(re),Pe=e=>()=>(0,te.m2)(e)(ae),Re=e=>()=>(0,te.lR)(e)(le),De=e=>()=>(0,te.kH)(e)(ce),Le=e=>()=>(0,te.Nu)(e)(ne);var Me=r(51485),Ae=r(41925);const Be=()=>{};var $e;!function(e){e.DISORDER="DISORDER",e.TIMEOUT="TIMEOUT"}($e||($e={}));const Ne={plain:Symbol("plain"),allHead:Symbol("allHead"),allTail:Symbol("allTail"),raceHead:Symbol("raceHead"),raceTail:Symbol("raceTail")},Ve=Symbol("head"),He=(e,t,r)=>({type:r,done:!1,timeout:t,endTime:0,id:e,prev:void 0,next:void 0}),Oe={},ze={},Ge=({eventId:e,scheduleId:t="",stepId:r,timeStamp:n=Date.now(),...o})=>{ze?.[e]?.[t]||(ze[e]={},ze[e][t]=[]),ze[e][t].push({stepId:r,...o,timeStamp:n}),Oe?.[e]?.[t]&&(ze[e][t]=(0,U.sortBy)(ze[e][t],(e=>e.timeStamp)),ze[e][t].forEach((({stepId:r,timeStamp:n,...o})=>{Oe[e][t][r]({...o,timeStamp:n,onEnd:()=>{delete Oe[e][t]}})})),ze[e][t]=[])};Ge.init=({scheduleId:e="",config:t={},eventId:r,step:n})=>{Oe?.[r]||(Oe[r]={}),Oe[r][e]=(({step:e,eventId:t,config:r={}})=>{const n=[];let o=Object.create(null);const a=e=>{const o=n.slice(0,20).reverse(),a=(0,Ae.v4)();if(o.length){const[n]=o;let s=n.status;for(let e=1;e<o.length;e++)s+=` <-${o[e-1].duration}- ${o[e].status}`;(0,ge.wu)(`ga_${t}`,{sessionId:a,duration:o[0].duration,statuses:s,status:n.status,...r,...e})}else(0,ge.wu)(`ga_${t}`,{sessionId:a,...r,...e})};let s=!1;const i=He((0,Ae.v4)(),1,Ne.plain),l=new Map;l.set(Ve,i),e.getMap(l,i);const c=l.get(Ve)?.next,u=new Map([[c.id,c]]),d=[];l.forEach(((e,t)=>{"string"==typeof t&&d.push(t)}));const m=e=>{o=e},p=()=>{s=!0},h=d.reduce(((e,t)=>(e[t]=({log:e=(e=>{}),catch:r=(e=>{}),onEnd:i=Be,timeStamp:l})=>{if(!s){if(u.has(t)){const s=u.get(t);if(l?s.endTime=l:s.prev&&!("size"in s.prev)?s.endTime=s.prev.endTime:s.endTime=Date.now(),u.delete(t),s.type===Ne.plain&&s.prev&&!("size"in s.prev)){const i=0===s.prev.endTime?0:s.endTime-s.prev.endTime;((e,t)=>{n.push({status:e,duration:t})})(t,i),i>1e3*s.timeout?r({error:$e.TIMEOUT,context:{...o,statusList:n},setContext:m,stop:p,trackGAEventParams:a}):e({context:{...o,statusList:n},setContext:m,stop:p,trackGAEventParams:a})}s.done=!0;const i=e=>{switch(e.type){case Ne.allHead:case Ne.raceHead:case Ne.raceTail:h[e.id]({});break;case Ne.allTail:if(e.prev&&"add"in e.prev){let t=0;e.prev.forEach((e=>{e.done&&t++})),t===e.prev.size&&h[e.id]({})}}};s.next&&("add"in s.next?s.next.forEach((e=>{u.set(e.id,e),i(e)})):(u.set(s.next.id,s.next),i(s.next)))}else r({error:$e.DISORDER,context:{...o,statusList:n},setContext:m,stop:p,trackGAEventParams:a}),s=!0;0===u.size&&i()}},e)),{});return h})({step:n,config:t,eventId:r})};const Ue=({id:e,timeout:t=1})=>{const r=[],n={_:e=>(r.push(e),n),getMap:(n,o)=>{const a=n.has(e)?n.get(e):He(e,t,Ne.plain);return o.next?"add"in o.next?o.next.add(a):o.next=new Set([o.next,a]):o.next=a,a.prev?"add"in a.prev?a.prev.add(o):a.prev=new Set([o,a.prev]):a.prev=o,n.has(e)?a:(n.set(e,a),o=a,r.forEach((e=>{o=e.getMap(n,o)})),o)}};return n};Ue.all=(...e)=>{const t=[],r={_:e=>(t.push(e),r),getMap:(r,n)=>{const o=He((0,Ae.v4)(),1,Ne.allHead),a=He((0,Ae.v4)(),1,Ne.allTail);return r.set(o.id,o),r.set(a.id,a),n.next?"add"in n.next?n.next.add(o):n.next=new Set([n.next,o]):n.next=o,o.prev=n,o.next=new Set,a.prev=new Set,e.forEach((e=>{const t=e.getMap(r,o);t.next=a,a.prev.add(t)})),n=a,t.forEach((e=>{n=e.getMap(r,n)})),n}};return r},Ue.race=(...e)=>{const t=[],r={_:e=>(t.push(e),r),getMap:(r,n)=>{const o=He((0,Ae.v4)(),1,Ne.raceHead),a=He((0,Ae.v4)(),1,Ne.raceTail);return r.set(o.id,o),r.set(a.id,a),n.next?"add"in n.next?n.next.add(o):n.next=new Set([n.next,o]):n.next=o,o.prev=n,o.next=new Set,a.prev=new Set,e.forEach((e=>{const t=e.getMap(r,o);t.next=a,a.prev.add(t)})),n=a,t.forEach((e=>{n=e.getMap(r,n)})),n}};return r};const We=e=>{const t=Math.floor(e/1e3);return t<=100?t:100*Math.floor(t/100)};var Fe=r(58407),Ze=r(70176),je=r(512),Qe=r(39608),Ke=r(4401),qe=r(91359);const Ye=new Map;var Je=r(89663),Xe=r(41822),et=r(17921),tt=r(82452),rt=r(2547),nt=r(96988),ot=r(9824),at=r.n(ot),st=r(23773),it=r.n(st),lt=r(15032),ct=r.n(lt),ut=r(90982),dt=r.n(ut),mt=r(64172),pt=r.n(mt),ht=r(43194),yt=r.n(ht),ft=r(54241),gt=r.n(ft),bt=r(46012),vt=r.n(bt),St=r(41157),Ct=r.n(St);at().extend(it()),at().extend(ct()),at().extend(vt()),at().extend(Ct()),at().extend(pt()),at().extend(dt()),at().extend(yt()),at().extend(gt());const _t=at();var wt=r(19910),Tt=r(97655),kt=r(82521),Et=r(76922);const It=({symbol:e,chartRef:t})=>{const{dumb:r,dumbPositionSubgraph:n,dumbHistorySubgraph:o}=(0,rt.B)(),{tradingMode:a}=(0,s.C)(),{getI18n:i}=(0,nt.V6)(),l=(0,tt.q)();(0,Et.X)({symbol:e,chartRef:t}),(0,kt.b)({symbol:e,chartRef:t});const c=(0,Xe.NL)();return(0,$.D)((async()=>{if("dumb"!==a||!r)return[];const[t,s]=[c.getQueryData([wt.a.DumbPositionList,e,n]),c.getQueryData([wt.a.DumbHistoryList,e,o])],u=window.getComputedStyle(document.documentElement).getPropertyValue("--colors-t-buy"),d=window.getComputedStyle(document.documentElement).getPropertyValue("--colors-t-sell"),m=window.getComputedStyle(document.documentElement).getPropertyValue("--colors-interactive-primary");return[...t&&t?.data?.length>0?t?.data?.map((e=>{return{id:e.positionHash,time:e.startTime,borderWidth:1,hoveredBorderWidth:2,color:{background:e.isLong?u:d,border:"#fff"},text:(t=e,`${t.isLong?i("chart-dumb-long","Long"):i("chart-dumb-short","Short")}\n${i("userinfo-positions-column-entryPrice","Entry Price")}:\t${(0,Je.uf)(t.entryPrice,l[Tt.a[t.tokenIn]??t.tokenIn]?.assetDecimal)}\n${i("chart-dumb-openTime","Open time")}:\t${_t(1e3*t.startTime).format("mm:ss")}\n${i("chart-dumb-amount","Amount")}:\t${t.principal} ${Tt.a[t.tokenIn]??t.tokenIn}`),label:e.isLong?"L":"S",labelFontColor:"#fff",minSize:25};var t})):[],...(s&&s?.pages?.length>0?s?.pages?.reduce(((e,t)=>[...e,...t.data]),[]):[]).map((e=>{const t=e.isLong?Number(e.executionPrice)>Number(e.entryPrice):Number(e.entryPrice)>Number(e.executionPrice),r=t?new et.Z(e.pnl||0).minus(e.closeFee||0).div(e.principal||1):-1,n=t?new et.Z(e.pnl||0).minus(e.closeFee||0):new et.Z(e.principal||0).multipliedBy(r),o=(0,Je.uf)(n,l[Tt.a[e.tokenIn]??e.tokenIn]?.assetDecimal);return{id:e.positionHash,time:e.executionTime,borderWidth:1,hoveredBorderWidth:2,color:{background:m,border:"#fff"},text:(a=e,`${i("chart-dumb-expire","Expire")}${t?"ðŸ¤‘":"ðŸ˜ˆ"}\n${i("userinfo-positions-column-entryPrice","Entry Price")}:\t${(0,Je.uf)(a.entryPrice,l[Tt.a[a.tokenIn]??a.tokenIn]?.assetDecimal)}\n${i("userinfo-positions-column-expirePrice","Expire Price")}:\t${(0,Je.uf)(a.executionPrice,l[Tt.a[a.tokenIn]??a.tokenIn]?.assetDecimal)}\n${i("chart-dumb-expireTime","Expire time")}:\t${_t(1e3*a.executionTime).format("mm:ss")}\n${i("chart-dumb-pnl","PNL")}:\t${t?"+":""}${o} ${a.tokenIn}`),label:"E",labelFontColor:"#fff",minSize:25};var a}))]}))},xt=new Fe.v;async function Pt(e,t){const r=Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&"),n=await(0,Me.U2)(`${e}?${r}`);return n?.code?n.data:n}const Rt=({symbol:e,namespace:t,chartRef:r,contractType:n,reconnectTVTimes:a,TICK_SIZE:s,reloadTV:i})=>{const[l]=xe(t)(),c=Ce()[e],{pair:u="",tickSize:d=""}=c||{},m=(({pair:e,contractType:t,symbol:r,interval:n,reconnectTimes:a,chartRef:s})=>{const i=It({symbol:r,chartRef:s}),l=(0,o.useRef)((0,Ae.v4)()),c=(0,o.useRef)((()=>0)),u=(0,o.useRef)({klineDataQueue:[]}),d=(0,o.useRef)([]),m=(0,o.useRef)(),p=(0,o.useRef)(0),h=(0,o.useRef)((function(){})),y=((e,t)=>{const r="1s"===t,{uuid:n}=(0,te.QK)(),a=(0,o.useMemo)((()=>`i${e?.toUpperCase()}@kline_${r?"1m":t}`),[e,t,r]),{online:s}=(0,Ze.Z)(),{lastJsonMessage:i,sendJsonMessage:l,readyState:c}=(0,Qe.ZP)(`${X.brokerConfig.futuresWsHost}/stream`,{share:!0,filter:(0,qe.eJ)(a),shouldReconnect:e=>1e3!==e.code},s),u=(0,o.useRef)(!1);(0,o.useEffect)((()=>{1===c&&!1===u.current&&(u.current=!0)}),[c]);const d=(0,je.Z)(c);(0,o.useEffect)((()=>{0===d&&1===c&&Ye.size>0&&u.current&&Ye.forEach(((e,t)=>{const r=n();l({method:"SUBSCRIBE",params:[t],id:r})}))}),[s,d,c,l,a,n]);const m=(0,o.useCallback)((()=>{const e=n();return Ye.has(a)?Ye.set(a,(Ye.get(a)??0)+1):(l({method:"SUBSCRIBE",params:[a],id:e}),Ye.set(a,1)),function(){const t=Ye.get(a);t&&t>0&&Ye.set(a,(Ye.get(a)??0)-1),void 0!==t&&t<=1&&(l({method:"UNSUBSCRIBE",params:[a],id:e}),Ye.delete(a))}}),[l,a,n]);return(0,o.useEffect)((()=>{const e=m();return()=>e()}),[m]),(0,o.useMemo)((()=>i?.data&&i?.stream===a?{condition:{symbol:e,interval:t},...(0,Ke.Vs)(i?.data,{pair:"ps",contractType:"ct",eventTime:"E",symbol:"s",time:r?"E":(0,Ke.cP)("k.t"),open:Ke.zW.number("k.o"),close:Ke.zW.number("k.c"),high:r?Ke.zW.number("k.c"):Ke.zW.number("k.h"),low:r?Ke.zW.number("k.c"):Ke.zW.number("k.l"),volume:Ke.zW.number("k.v"),quantity:Ke.zW.number("k.q")})}:void 0),[i?.data,i?.stream,a,r,e,t])})(r,n);m.current={klineData:y};const g=(0,o.useMemo)((()=>(0,U.throttle)((()=>{xt.emit(l.current,"")}),1e3)),[]);(0,o.useEffect)((()=>{y&&g()}),[y,g]);const b=(0,$.D)((e=>{const t=e[e.length-1]?.time;t&&t>p.current&&(p.current=t)})),v=(0,$.D)((e=>{if(0===p.current)return;const t=1e3*(0,Ke.$n)(n);e-p.current>=10*t&&h.current?.()})),S=(0,$.D)((e=>{h.current=e})),C=(0,$.D)((({interval:e,pair:t,contractType:o,bizDataReducers:a})=>function(t,s){let i=!1;const l="1s"===n;async function c({startTime:n=0,endTime:c=0},d=(()=>{}),m=(()=>{})){const p=1e3;let h=-1,y=!1,f=n;const g=[];for(;-1===h||h===p;)try{const n=-1===h?f:Number(f)+1,s=l?{startTime:`${n}`,endTime:`${c>Date.now()?Date.now():c}`,limit:p}:{interval:e,contractType:o,...0!==c&&{startTime:n,endTime:c,limit:p}};s.symbol=r;const i=await t(l?"/bapi/futures/v1/public/future/apx/V2MarkPriceKline":"/fapi/v1/markPriceKlines",s);if(!i||0===i.length)break;h=i.length,i.forEach((e=>{const[t,r,n,o,s,i="0",,c="0"]=e.map(Number),u=a.reduce(((e,t)=>t(e)),{time:l?1e3*t:t,open:r,high:n,low:o,close:s,volume:l?0:i,quantity:l?0:c,id:(0,Ae.v4)()});g.push(u)})),f=g[g.length-1].time}catch(e){y=!0,m(e);break}y||i||(s(g),u.current.klineDataQueue=g.slice(-100),d({data:g,isLoadAll:0===g.length}))}return c.abort=()=>{i=!0},c})),_=(0,$.D)(((e,t)=>{const{uid:r,resolution:n}=e;return c.current=xt.on(l.current,(()=>{const{klineData:e}=m.current||{},o=`${e?.condition.symbol}_#_${ee.nw[e?.condition.interval]}`;if(!e||r!==o)return;e.id=(0,Ae.v4)(),(0,Ke.SP)(u.current.klineDataQueue,f()(e));const a=d.current.reduce(((e,t)=>t(e)),e),{time:s}=a;v(s),s>p.current&&(p.current=s),"1S"===n&&(a.open=a.close,a.high=a.close,a.low=a.close),t&&t(a)})),c.current}));return(0,o.useMemo)((()=>({subscribe:_,unsubscribe:c.current,getData:C({interval:n,pair:e,contractType:t,bizDataReducers:d.current})(Pt,b),setDisconnectCallback:S,bizDataReducers:d.current,trackingData:u.current,getMarks:i})),[t,C,i,n,e,S,_,b,a,i])})({reconnectTimes:a,pair:u,contractType:n,symbol:e,interval:l,chartRef:r});(0,o.useEffect)((()=>{m.setDisconnectCallback((()=>i((e=>-1*e))))}),[i,m]);const p=(0,o.useMemo)((()=>((e,{tickSize:t,isFutures:r=!1})=>{const n=new Map;let o,a,s,i=t,l=e;const c=(0,U.once)((e=>Ge({eventId:"trd_chart_tv_load_timeout",stepId:"getBarsEnd",catch({error:t,trackGAEventParams:r}){r({GET_BAR_END_TYPE:t,duration_:We(e-s)})},log({trackGAEventParams:t}){t({GET_BAR_END_TYPE:"SUCCESS",duration_:We(e-s)})}}))),u=(0,U.once)((()=>Ge({eventId:"trd_chart_tv_load_timeout",stepId:"getBarsStart",catch({error:e,trackGAEventParams:t}){t({GET_BAR_START_TYPE:e})},log({trackGAEventParams:e}){e({GET_BAR_START_TYPE:"SUCCESS"})}})));return{getBars:async function(...e){let[t,r,n,a]=[0,0,(...e)=>{},e=>{}];"number"==typeof e[2]?(t=e[2],r=e[3],n=e[4],a=e[5]):(t=e[2].from,r=e[2].to,n=e[3],a=e[4]),s=Date.now(),u();try{const e=Math.max(0,1e3*t),s=1e3*r;if(s<0)return void n([],{noData:!0});await l.getData({startTime:e,endTime:s},(({data:e=[]})=>{c(Date.now());const t=document.querySelector(`#${o}`);try{t&&n(e,{noData:!e.length})}catch(e){}}),(e=>{a(e)}))}catch(e){}},getMarks:async(e,t,r,n)=>{n(await l.getMarks())},setDataProvider:function(e){l=e},setTickSize:function(e){i=e},setContainerId:function(e){o=e},onReady:function(e){setTimeout((()=>{e({exchanges:[],symbols_types:[],supported_resolutions:ee.Tz,supports_marks:!0,supports_timescale_marks:!0,supports_time:!0})}),0)},searchSymbols:function(){},resolveSymbol:function(e,t){const r={description:e,fractional:!1,has_intraday:!0,has_daily:!0,has_weekly_and_monthly:!0,minmov:1,minmove2:0,name:e,ticker:e,timezone:"Etc/UTC",pricescale:10**Math.abs(Math.log10(i)),session:"24x7",type:"crypto",has_seconds:!0,hash_empty_bar:!0};setTimeout((()=>{t&&t(r)}),0)},subscribeBars:async function(e,t,r,o){const s=l.subscribe({symbolInfo:e,resolution:t,uid:o},(e=>{const{time:t,open:n,high:o,low:a,close:s,volume:i}=e;r({time:t,open:n,high:o,low:a,close:s,volume:i})}));a=s,n.set(o,s)},unsubscribeBars:function(e){n.get(e)?.()},getServerTime:async function(e){try{const{serverTime:t}=await(async e=>await(async(e,t)=>await(0,Me.U2)(`/${e?"dapi":"fapi"}/v1/time`,{enableErrorMsgIntercept:!1}))(!e))(r);e(Math.floor(parseInt(`${t}`,10)/1e3))}catch(t){e(Date.now())}},unsubscribe:function(){a?.()}}})(m,{tickSize:s,isFutures:!0})),[]);return(0,o.useEffect)((()=>{p.setDataProvider(m)}),[m]),(0,o.useEffect)((()=>{p.setTickSize(d)}),[d,p]),p},Dt="https://benchmarks.pyth.network/v1/shims/tradingview",Lt=async({ticker:e,from:t,to:r,resolution:n,isReverse:o})=>{const a=await fetch(`${Dt}/history?symbol=${e}&from=${t}&to=${r}&resolution=${n}`),s=await a.json();if(0===s.t.length)return[];const i=[];for(let e=0;e<s.t.length;++e)i.push({time:1e3*s.t[e],low:o?1/s.l[e]:s.l[e],high:o?1/s.h[e]:s.h[e],open:o?1/s.o[e]:s.o[e],close:o?1/s.c[e]:s.c[e],id:(0,Ae.v4)()});return i};var Mt=r(22645),At=r(59712);const Bt=31536e3,$t=new Map,Nt=new Map,Vt=({symbol:e,TICK_SIZE:t,chartRef:r})=>{const n=It({symbol:e,chartRef:r}),{isReverse:a}=(0,_e.NE)(e),s=Ce()[e],{tickSize:i=t}=s||{},l=(0,o.useMemo)((()=>(({symbol:e,tickSize:t,isReverse:r,getMarks:n})=>{let o=t;return{onReady:async e=>{const t={...await(async()=>{const e=await fetch(`${Dt}/config`);return await e.json()})(),supported_resolutions:ee.Tz,supports_marks:!0,supports_timescale_marks:!0,supports_time:!0};(0,Mt._M)(),setTimeout((()=>e(t)))},searchSymbols:()=>{},resolveSymbol:async(e,t,n)=>{const a=-1===e.indexOf(".")&&r?`USD${e.replace(/USD/,"")}`:e;At.debug("[resolveSymbol]: Method call",a);try{const e=await(async e=>{const t=await fetch(`${Dt}/symbols?symbol=${e}`);return await t.json()})(a);At.debug("[resolveSymbol]: Symbol resolved",e),t({...e,has_seconds:!0,supported_resolutions:ee.Tz,pricescale:10**Math.abs(Math.log10(o))})}catch(e){At.debug("[resolveSymbol]: Cannot resolve symbol",a),n("Cannot resolve symbol")}},getBars:async(t,n,o,a,s)=>{const{from:i,to:l,firstDataRequest:c}=o;At.debug("[getBars]: Method call",t,n,i,l);try{let s=[];if("1S"===n)s=await(async({symbol:e,from:t,to:r})=>{const n=(await(0,Me.U2)(`/bapi/futures/v1/public/future/apx/V2MarkPriceKline?symbol=${e}&startTime=${1e3*t}&endTime=${1e3*r}&limit=1000`)).data??[];if(0===n.length)return[];const o=[];return n.forEach((e=>{const[t,r,n,a,s]=e.map(Number),i={time:1e3*t,open:r,high:n,low:a,close:s,id:(0,Ae.v4)()};o.push(i)})),o})({symbol:e,from:o.from,to:1e3*o.to>Date.now()?Date.now()/1e3:o.to});else{const e=`${t.ticker}_${n}`;if(o.to<=Nt.get(e)?.to)return void a([],{noData:!0});const i=["1M","1W"].includes(n)?4:2,l=function(e,t){let r=t;const n=[];for(;r>e;){const t=r-Bt<=e?e:r-Bt;n.push({from:t,to:r}),r=t}return n}(o.from,o.to),c=[];for(;l.length>0;){const o=l.splice(0,i),a=await Promise.all(o.map((({from:e,to:o})=>Lt({ticker:t.ticker,from:e,to:o,resolution:n,isReverse:r}))));a.filter((e=>e.length>0)).map((e=>c.push(e)));const s=a.findIndex((e=>0===e.length));if(-1!==s){Nt.set(e,o[s]);break}}s=c.reverse().reduce(((e,t)=>[...e,...t]),[])}if(0===s.length)return void a([],{noData:!0});c&&$t.set(t.ticker,{...s[s.length-1]}),a(s,{noData:!1})}catch(e){At.debug("[getBars]: Get error",e),s(e)}},getMarks:async(e,t,r,o)=>{o(await n())},subscribeBars:(e,t,r,n)=>{At.debug("[subscribeBars]: Method call with subscriberUID:",n),(0,Mt.Aj)(e.ticker??"",r,n,$t.get(e.ticker))},unsubscribeBars:e=>{At.debug("[unsubscribeBars]: Method call with subscriberUID:",e),(0,Mt.VA)(e)},unsubscribe:()=>{},setTickSize:e=>{o=e}}})({symbol:e,tickSize:i,getMarks:n,isReverse:a})),[e,i,n,a]);return(0,o.useEffect)((()=>{l.setTickSize(i)}),[i,l]),l},Ht=({symbol:e,namespace:t})=>(0,o.useMemo)((()=>({orderLines:[]})),[]),Ot=({symbol:e,namespace:t})=>(0,o.useMemo)((()=>({positionLines:[]})),[]),zt="trd_chart_tv_load_timeout",Gt=()=>{const e=Ue({id:"chartReady"}),t=Ue({id:"getBarsStart",timeout:3}),r=Ue({id:"getBarsEnd",timeout:6}),n=Ue({id:"chartResponsive",timeout:3});Ge.init({step:e._(t)._(r)._(n),eventId:zt}),Ge({eventId:zt,stepId:"chartReady",catch({error:e,trackGAEventParams:t}){t({CHART_READY_TYPE:e,connection:JSON.stringify(navigator.connection)})},log({trackGAEventParams:e}){e({CHART_READY_TYPE:"SUCCESS",connection:JSON.stringify(navigator.connection)})}})},Ut=e=>{Ge({eventId:zt,stepId:"chartResponsive",catch({error:e,trackGAEventParams:t}){t({CHART_RESPONSIVE_TYPE:e,connection:JSON.stringify(navigator.connection)})},log({trackGAEventParams:t}){t({CHART_RESPONSIVE_TYPE:"SUCCESS",duration_:We(Date.now()-e)})}})};function Wt({namespace:e=be.MM}){const t=(0,o.useMemo)((()=>G().createInstance({name:e})),[e]),{symbol:r}=(0,te.Dp)(),{supportPyth:a}=(0,_e.NE)(r),{getI18n:s}=(0,ee.ZK)(),i=(0,te.v5)(e)(ue),l=we(e),c=Te(e),u=ke(e),d=Ee(e),m=Ie(e),p=xe(e),h=Pe(e),y=Re(e),f=De(e),g=Le(e);return(0,n.jsx)(J,{getI18n:s,useLng:he.tZ,STATIC_HOST:X.brokerConfig.staticBaseUrl,TRADINGVIEW_STATIC_PATH:X.brokerConfig.TRADINGVIEW_STATIC_PATH,namespace:e,storage:t,symbol:r,showLoading:i,electron:fe.Z,trackGAEvent:ge.wu,logOnChartReady:Gt,logOnChartResponsive:Ut,useOrderLine:Ht,usePositionLine:Ot,useTheme:ye.F,useThemeScheme:pe.n,useAllProduct:Ce,useCreateDatafeed:a?Vt:Rt,useLoadingStore:l,useTvChartStyleStore:c,useIfShowTVIndicatorsMenu:u,useToggleShowTVIndicatorsMenu:d,useIntervalConfigStore:m,useIntervalStore:p,useSelectedIntervalsStore:h,useIsEditingIntervalStore:y,usePriceTypeStore:f,useChartTypeStore:g},a?"pyth":"origin")}}}]);